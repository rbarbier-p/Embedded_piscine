#include "SPI_lib.h"
#include "ADC_lib.h"

void main(void)
{
	SPI_master_init();
  ADC_init();

  uint8_t value_read;
  while (1) {
    value_read = ADC_read_RV1();

    SPI_APA102_start();
    if (value_read == 255) {
      SPI_APA102_frame(0x1, 0x0, 0x0, 0xFF);
      SPI_APA102_frame(0x1, 0x0, 0x0, 0xFF);
      SPI_APA102_frame(0x1, 0x0, 0x0, 0xFF);
    }
    else if (value_read > 255 * 0.66) {
      SPI_APA102_frame(0x1, 0x0, 0x0, 0xFF);
      SPI_APA102_frame(0x1, 0x0, 0x0, 0xFF);
      SPI_APA102_frame(0x0, 0x0, 0x0, 0x0);
    }
    else if (value_read > 255 * 0.33) {
      SPI_APA102_frame(0x1, 0x0, 0x0, 0xFF);
      SPI_APA102_frame(0x0, 0x0, 0x0, 0x0);
      SPI_APA102_frame(0x0, 0x0, 0x0, 0x0);
    }
    else {
      SPI_APA102_frame(0x0, 0x0, 0x0, 0x0);
      SPI_APA102_frame(0x0, 0x0, 0x0, 0x0);
      SPI_APA102_frame(0x0, 0x0, 0x0, 0x0);
    }
    SPI_APA102_stop(); 
  }
}
